{"remainingRequest":"E:\\Downloads\\wiki-dev\\node_modules\\babel-loader\\lib\\index.js??ref--0-1!E:\\Downloads\\wiki-dev\\client\\libs\\codemirror-merge\\diff-match-patch.js","dependencies":[{"path":"E:\\Downloads\\wiki-dev\\client\\libs\\codemirror-merge\\diff-match-patch.js","mtime":1618944746000},{"path":"E:\\Downloads\\wiki-dev\\.babelrc","mtime":1618944746000},{"path":"E:\\Downloads\\wiki-dev\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1618998867176},{"path":"E:\\Downloads\\wiki-dev\\node_modules\\babel-loader\\lib\\index.js","mtime":1617693652020}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIGRpZmZfbWF0Y2hfcGF0Y2ggPSBmdW5jdGlvbiBkaWZmX21hdGNoX3BhdGNoKCkgewogIHRoaXMuRGlmZl9UaW1lb3V0ID0gMTsKICB0aGlzLkRpZmZfRWRpdENvc3QgPSA0OwogIHRoaXMuTWF0Y2hfVGhyZXNob2xkID0gLjU7CiAgdGhpcy5NYXRjaF9EaXN0YW5jZSA9IDFFMzsKICB0aGlzLlBhdGNoX0RlbGV0ZVRocmVzaG9sZCA9IC41OwogIHRoaXMuUGF0Y2hfTWFyZ2luID0gNDsKICB0aGlzLk1hdGNoX01heEJpdHMgPSAzMjsKfSwKICAgIERJRkZfREVMRVRFID0gLTEsCiAgICBESUZGX0lOU0VSVCA9IDEsCiAgICBESUZGX0VRVUFMID0gMDsKCmRpZmZfbWF0Y2hfcGF0Y2guRGlmZiA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgdGhpc1swXSA9IGE7CiAgdGhpc1sxXSA9IGI7Cn07CgpkaWZmX21hdGNoX3BhdGNoLkRpZmYucHJvdG90eXBlLmxlbmd0aCA9IDI7CgpkaWZmX21hdGNoX3BhdGNoLkRpZmYucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewogIHJldHVybiB0aGlzWzBdICsgIiwiICsgdGhpc1sxXTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfbWFpbiA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7CiAgInVuZGVmaW5lZCIgPT0gdHlwZW9mIGQgJiYgKGQgPSAwID49IHRoaXMuRGlmZl9UaW1lb3V0ID8gTnVtYmVyLk1BWF9WQUxVRSA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgMUUzICogdGhpcy5EaWZmX1RpbWVvdXQpOwogIGlmIChudWxsID09IGEgfHwgbnVsbCA9PSBiKSB0aHJvdyBFcnJvcigiTnVsbCBpbnB1dC4gKGRpZmZfbWFpbikiKTsKICBpZiAoYSA9PSBiKSByZXR1cm4gYSA/IFtuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGEpXSA6IFtdOwogICJ1bmRlZmluZWQiID09IHR5cGVvZiBjICYmIChjID0gITApOwogIHZhciBlID0gYywKICAgICAgZiA9IHRoaXMuZGlmZl9jb21tb25QcmVmaXgoYSwgYik7CiAgYyA9IGEuc3Vic3RyaW5nKDAsIGYpOwogIGEgPSBhLnN1YnN0cmluZyhmKTsKICBiID0gYi5zdWJzdHJpbmcoZik7CiAgZiA9IHRoaXMuZGlmZl9jb21tb25TdWZmaXgoYSwgYik7CiAgdmFyIGcgPSBhLnN1YnN0cmluZyhhLmxlbmd0aCAtIGYpOwogIGEgPSBhLnN1YnN0cmluZygwLCBhLmxlbmd0aCAtIGYpOwogIGIgPSBiLnN1YnN0cmluZygwLCBiLmxlbmd0aCAtIGYpOwogIGEgPSB0aGlzLmRpZmZfY29tcHV0ZV8oYSwgYiwgZSwgZCk7CiAgYyAmJiBhLnVuc2hpZnQobmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBjKSk7CiAgZyAmJiBhLnB1c2gobmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBnKSk7CiAgdGhpcy5kaWZmX2NsZWFudXBNZXJnZShhKTsKICByZXR1cm4gYTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY29tcHV0ZV8gPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgewogIGlmICghYSkgcmV0dXJuIFtuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfSU5TRVJULCBiKV07CiAgaWYgKCFiKSByZXR1cm4gW25ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9ERUxFVEUsIGEpXTsKICB2YXIgZSA9IGEubGVuZ3RoID4gYi5sZW5ndGggPyBhIDogYiwKICAgICAgZiA9IGEubGVuZ3RoID4gYi5sZW5ndGggPyBiIDogYSwKICAgICAgZyA9IGUuaW5kZXhPZihmKTsKICByZXR1cm4gLTEgIT0gZyA/IChjID0gW25ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9JTlNFUlQsIGUuc3Vic3RyaW5nKDAsIGcpKSwgbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBmKSwgbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0lOU0VSVCwgZS5zdWJzdHJpbmcoZyArIGYubGVuZ3RoKSldLCBhLmxlbmd0aCA+IGIubGVuZ3RoICYmIChjWzBdWzBdID0gY1syXVswXSA9IERJRkZfREVMRVRFKSwgYykgOiAxID09IGYubGVuZ3RoID8gW25ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9ERUxFVEUsIGEpLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfSU5TRVJULCBiKV0gOiAoZSA9IHRoaXMuZGlmZl9oYWxmTWF0Y2hfKGEsIGIpKSA/IChiID0gZVsxXSwgZiA9IGVbM10sIGEgPSBlWzRdLCBlID0gdGhpcy5kaWZmX21haW4oZVswXSwgZVsyXSwgYywgZCksIGMgPSB0aGlzLmRpZmZfbWFpbihiLCBmLCBjLCBkKSwgZS5jb25jYXQoW25ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgYSldLCBjKSkgOiBjICYmIDEwMCA8IGEubGVuZ3RoICYmIDEwMCA8IGIubGVuZ3RoID8gdGhpcy5kaWZmX2xpbmVNb2RlXyhhLCBiLCBkKSA6IHRoaXMuZGlmZl9iaXNlY3RfKGEsIGIsIGQpOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9saW5lTW9kZV8gPSBmdW5jdGlvbiAoYSwgYiwgYykgewogIHZhciBkID0gdGhpcy5kaWZmX2xpbmVzVG9DaGFyc18oYSwgYik7CiAgYSA9IGQuY2hhcnMxOwogIGIgPSBkLmNoYXJzMjsKICBkID0gZC5saW5lQXJyYXk7CiAgYSA9IHRoaXMuZGlmZl9tYWluKGEsIGIsICExLCBjKTsKICB0aGlzLmRpZmZfY2hhcnNUb0xpbmVzXyhhLCBkKTsKICB0aGlzLmRpZmZfY2xlYW51cFNlbWFudGljKGEpOwogIGEucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsICIiKSk7CgogIGZvciAodmFyIGUgPSBkID0gYiA9IDAsIGYgPSAiIiwgZyA9ICIiOyBiIDwgYS5sZW5ndGg7KSB7CiAgICBzd2l0Y2ggKGFbYl1bMF0pIHsKICAgICAgY2FzZSBESUZGX0lOU0VSVDoKICAgICAgICBlKys7CiAgICAgICAgZyArPSBhW2JdWzFdOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBESUZGX0RFTEVURToKICAgICAgICBkKys7CiAgICAgICAgZiArPSBhW2JdWzFdOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBESUZGX0VRVUFMOgogICAgICAgIGlmICgxIDw9IGQgJiYgMSA8PSBlKSB7CiAgICAgICAgICBhLnNwbGljZShiIC0gZCAtIGUsIGQgKyBlKTsKICAgICAgICAgIGIgPSBiIC0gZCAtIGU7CiAgICAgICAgICBkID0gdGhpcy5kaWZmX21haW4oZiwgZywgITEsIGMpOwoKICAgICAgICAgIGZvciAoZSA9IGQubGVuZ3RoIC0gMTsgMCA8PSBlOyBlLS0pIGEuc3BsaWNlKGIsIDAsIGRbZV0pOwoKICAgICAgICAgIGIgKz0gZC5sZW5ndGg7CiAgICAgICAgfQoKICAgICAgICBkID0gZSA9IDA7CiAgICAgICAgZyA9IGYgPSAiIjsKICAgIH0KCiAgICBiKys7CiAgfQoKICBhLnBvcCgpOwogIHJldHVybiBhOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9iaXNlY3RfID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsKICBmb3IgKHZhciBkID0gYS5sZW5ndGgsIGUgPSBiLmxlbmd0aCwgZiA9IE1hdGguY2VpbCgoZCArIGUpIC8gMiksIGcgPSAyICogZiwgaCA9IEFycmF5KGcpLCBsID0gQXJyYXkoZyksIGsgPSAwOyBrIDwgZzsgaysrKSBoW2tdID0gLTEsIGxba10gPSAtMTsKCiAgaFtmICsgMV0gPSAwOwogIGxbZiArIDFdID0gMDsKICBrID0gZCAtIGU7CgogIGZvciAodmFyIG0gPSAwICE9IGsgJSAyLCBwID0gMCwgeCA9IDAsIHcgPSAwLCBxID0gMCwgdCA9IDA7IHQgPCBmICYmICEobmV3IERhdGUoKS5nZXRUaW1lKCkgPiBjKTsgdCsrKSB7CiAgICBmb3IgKHZhciB2ID0gLXQgKyBwOyB2IDw9IHQgLSB4OyB2ICs9IDIpIHsKICAgICAgdmFyIG4gPSBmICsgdjsKICAgICAgdmFyIHIgPSB2ID09IC10IHx8IHYgIT0gdCAmJiBoW24gLSAxXSA8IGhbbiArIDFdID8gaFtuICsgMV0gOiBoW24gLSAxXSArIDE7CgogICAgICBmb3IgKHZhciB5ID0gciAtIHY7IHIgPCBkICYmIHkgPCBlICYmIGEuY2hhckF0KHIpID09IGIuY2hhckF0KHkpOykgcisrLCB5Kys7CgogICAgICBoW25dID0gcjsKICAgICAgaWYgKHIgPiBkKSB4ICs9IDI7ZWxzZSBpZiAoeSA+IGUpIHAgKz0gMjtlbHNlIGlmIChtICYmIChuID0gZiArIGsgLSB2LCAwIDw9IG4gJiYgbiA8IGcgJiYgLTEgIT0gbFtuXSkpIHsKICAgICAgICB2YXIgdSA9IGQgLSBsW25dOwogICAgICAgIGlmIChyID49IHUpIHJldHVybiB0aGlzLmRpZmZfYmlzZWN0U3BsaXRfKGEsIGIsIHIsIHksIGMpOwogICAgICB9CiAgICB9CgogICAgZm9yICh2ID0gLXQgKyB3OyB2IDw9IHQgLSBxOyB2ICs9IDIpIHsKICAgICAgbiA9IGYgKyB2OwogICAgICB1ID0gdiA9PSAtdCB8fCB2ICE9IHQgJiYgbFtuIC0gMV0gPCBsW24gKyAxXSA/IGxbbiArIDFdIDogbFtuIC0gMV0gKyAxOwoKICAgICAgZm9yIChyID0gdSAtIHY7IHUgPCBkICYmIHIgPCBlICYmIGEuY2hhckF0KGQgLSB1IC0gMSkgPT0gYi5jaGFyQXQoZSAtIHIgLSAxKTspIHUrKywgcisrOwoKICAgICAgbFtuXSA9IHU7CiAgICAgIGlmICh1ID4gZCkgcSArPSAyO2Vsc2UgaWYgKHIgPiBlKSB3ICs9IDI7ZWxzZSBpZiAoIW0gJiYgKG4gPSBmICsgayAtIHYsIDAgPD0gbiAmJiBuIDwgZyAmJiAtMSAhPSBoW25dICYmIChyID0gaFtuXSwgeSA9IGYgKyByIC0gbiwgdSA9IGQgLSB1LCByID49IHUpKSkgcmV0dXJuIHRoaXMuZGlmZl9iaXNlY3RTcGxpdF8oYSwgYiwgciwgeSwgYyk7CiAgICB9CiAgfQoKICByZXR1cm4gW25ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9ERUxFVEUsIGEpLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfSU5TRVJULCBiKV07Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2Jpc2VjdFNwbGl0XyA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkLCBlKSB7CiAgdmFyIGYgPSBhLnN1YnN0cmluZygwLCBjKSwKICAgICAgZyA9IGIuc3Vic3RyaW5nKDAsIGQpOwogIGEgPSBhLnN1YnN0cmluZyhjKTsKICBiID0gYi5zdWJzdHJpbmcoZCk7CiAgZiA9IHRoaXMuZGlmZl9tYWluKGYsIGcsICExLCBlKTsKICBlID0gdGhpcy5kaWZmX21haW4oYSwgYiwgITEsIGUpOwogIHJldHVybiBmLmNvbmNhdChlKTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfbGluZXNUb0NoYXJzXyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgZnVuY3Rpb24gYyhhKSB7CiAgICBmb3IgKHZhciBiID0gIiIsIGMgPSAwLCBnID0gLTEsIGggPSBkLmxlbmd0aDsgZyA8IGEubGVuZ3RoIC0gMTspIHsKICAgICAgZyA9IGEuaW5kZXhPZigiXG4iLCBjKTsKICAgICAgLTEgPT0gZyAmJiAoZyA9IGEubGVuZ3RoIC0gMSk7CiAgICAgIHZhciBsID0gYS5zdWJzdHJpbmcoYywgZyArIDEpOwogICAgICAoZS5oYXNPd25Qcm9wZXJ0eSA/IGUuaGFzT3duUHJvcGVydHkobCkgOiB2b2lkIDAgIT09IGVbbF0pID8gYiArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGVbbF0pIDogKGggPT0gZiAmJiAobCA9IGEuc3Vic3RyaW5nKGMpLCBnID0gYS5sZW5ndGgpLCBiICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoaCksIGVbbF0gPSBoLCBkW2grK10gPSBsKTsKICAgICAgYyA9IGcgKyAxOwogICAgfQoKICAgIHJldHVybiBiOwogIH0KCiAgdmFyIGQgPSBbXSwKICAgICAgZSA9IHt9OwogIGRbMF0gPSAiIjsKICB2YXIgZiA9IDRFNCwKICAgICAgZyA9IGMoYSk7CiAgZiA9IDY1NTM1OwogIHZhciBoID0gYyhiKTsKICByZXR1cm4gewogICAgY2hhcnMxOiBnLAogICAgY2hhcnMyOiBoLAogICAgbGluZUFycmF5OiBkCiAgfTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY2hhcnNUb0xpbmVzXyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgZm9yICh2YXIgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSB7CiAgICBmb3IgKHZhciBkID0gYVtjXVsxXSwgZSA9IFtdLCBmID0gMDsgZiA8IGQubGVuZ3RoOyBmKyspIGVbZl0gPSBiW2QuY2hhckNvZGVBdChmKV07CgogICAgYVtjXVsxXSA9IGUuam9pbigiIik7CiAgfQp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9jb21tb25QcmVmaXggPSBmdW5jdGlvbiAoYSwgYikgewogIGlmICghYSB8fCAhYiB8fCBhLmNoYXJBdCgwKSAhPSBiLmNoYXJBdCgwKSkgcmV0dXJuIDA7CgogIGZvciAodmFyIGMgPSAwLCBkID0gTWF0aC5taW4oYS5sZW5ndGgsIGIubGVuZ3RoKSwgZSA9IGQsIGYgPSAwOyBjIDwgZTspIGEuc3Vic3RyaW5nKGYsIGUpID09IGIuc3Vic3RyaW5nKGYsIGUpID8gZiA9IGMgPSBlIDogZCA9IGUsIGUgPSBNYXRoLmZsb29yKChkIC0gYykgLyAyICsgYyk7CgogIHJldHVybiBlOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9jb21tb25TdWZmaXggPSBmdW5jdGlvbiAoYSwgYikgewogIGlmICghYSB8fCAhYiB8fCBhLmNoYXJBdChhLmxlbmd0aCAtIDEpICE9IGIuY2hhckF0KGIubGVuZ3RoIC0gMSkpIHJldHVybiAwOwoKICBmb3IgKHZhciBjID0gMCwgZCA9IE1hdGgubWluKGEubGVuZ3RoLCBiLmxlbmd0aCksIGUgPSBkLCBmID0gMDsgYyA8IGU7KSBhLnN1YnN0cmluZyhhLmxlbmd0aCAtIGUsIGEubGVuZ3RoIC0gZikgPT0gYi5zdWJzdHJpbmcoYi5sZW5ndGggLSBlLCBiLmxlbmd0aCAtIGYpID8gZiA9IGMgPSBlIDogZCA9IGUsIGUgPSBNYXRoLmZsb29yKChkIC0gYykgLyAyICsgYyk7CgogIHJldHVybiBlOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9jb21tb25PdmVybGFwXyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgdmFyIGMgPSBhLmxlbmd0aCwKICAgICAgZCA9IGIubGVuZ3RoOwogIGlmICgwID09IGMgfHwgMCA9PSBkKSByZXR1cm4gMDsKICBjID4gZCA/IGEgPSBhLnN1YnN0cmluZyhjIC0gZCkgOiBjIDwgZCAmJiAoYiA9IGIuc3Vic3RyaW5nKDAsIGMpKTsKICBjID0gTWF0aC5taW4oYywgZCk7CiAgaWYgKGEgPT0gYikgcmV0dXJuIGM7CiAgZCA9IDA7CgogIGZvciAodmFyIGUgPSAxOzspIHsKICAgIHZhciBmID0gYS5zdWJzdHJpbmcoYyAtIGUpOwogICAgZiA9IGIuaW5kZXhPZihmKTsKICAgIGlmICgtMSA9PSBmKSByZXR1cm4gZDsKICAgIGUgKz0gZjsKICAgIGlmICgwID09IGYgfHwgYS5zdWJzdHJpbmcoYyAtIGUpID09IGIuc3Vic3RyaW5nKDAsIGUpKSBkID0gZSwgZSsrOwogIH0KfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfaGFsZk1hdGNoXyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgZnVuY3Rpb24gYyhhLCBiLCBjKSB7CiAgICBmb3IgKHZhciBkID0gYS5zdWJzdHJpbmcoYywgYyArIE1hdGguZmxvb3IoYS5sZW5ndGggLyA0KSksIGUgPSAtMSwgZyA9ICIiLCBoLCBrLCBsLCBtOyAtMSAhPSAoZSA9IGIuaW5kZXhPZihkLCBlICsgMSkpOykgewogICAgICB2YXIgcCA9IGYuZGlmZl9jb21tb25QcmVmaXgoYS5zdWJzdHJpbmcoYyksIGIuc3Vic3RyaW5nKGUpKSwKICAgICAgICAgIHUgPSBmLmRpZmZfY29tbW9uU3VmZml4KGEuc3Vic3RyaW5nKDAsIGMpLCBiLnN1YnN0cmluZygwLCBlKSk7CiAgICAgIGcubGVuZ3RoIDwgdSArIHAgJiYgKGcgPSBiLnN1YnN0cmluZyhlIC0gdSwgZSkgKyBiLnN1YnN0cmluZyhlLCBlICsgcCksIGggPSBhLnN1YnN0cmluZygwLCBjIC0gdSksIGsgPSBhLnN1YnN0cmluZyhjICsgcCksIGwgPSBiLnN1YnN0cmluZygwLCBlIC0gdSksIG0gPSBiLnN1YnN0cmluZyhlICsgcCkpOwogICAgfQoKICAgIHJldHVybiAyICogZy5sZW5ndGggPj0gYS5sZW5ndGggPyBbaCwgaywgbCwgbSwgZ10gOiBudWxsOwogIH0KCiAgaWYgKDAgPj0gdGhpcy5EaWZmX1RpbWVvdXQpIHJldHVybiBudWxsOwogIHZhciBkID0gYS5sZW5ndGggPiBiLmxlbmd0aCA/IGEgOiBiLAogICAgICBlID0gYS5sZW5ndGggPiBiLmxlbmd0aCA/IGIgOiBhOwogIGlmICg0ID4gZC5sZW5ndGggfHwgMiAqIGUubGVuZ3RoIDwgZC5sZW5ndGgpIHJldHVybiBudWxsOwogIHZhciBmID0gdGhpcywKICAgICAgZyA9IGMoZCwgZSwgTWF0aC5jZWlsKGQubGVuZ3RoIC8gNCkpOwogIGQgPSBjKGQsIGUsIE1hdGguY2VpbChkLmxlbmd0aCAvIDIpKTsKICBpZiAoZyB8fCBkKSBnID0gZCA/IGcgPyBnWzRdLmxlbmd0aCA+IGRbNF0ubGVuZ3RoID8gZyA6IGQgOiBkIDogZztlbHNlIHJldHVybiBudWxsOwoKICBpZiAoYS5sZW5ndGggPiBiLmxlbmd0aCkgewogICAgZCA9IGdbMF07CiAgICBlID0gZ1sxXTsKICAgIHZhciBoID0gZ1syXTsKICAgIHZhciBsID0gZ1szXTsKICB9IGVsc2UgaCA9IGdbMF0sIGwgPSBnWzFdLCBkID0gZ1syXSwgZSA9IGdbM107CgogIHJldHVybiBbZCwgZSwgaCwgbCwgZ1s0XV07Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2NsZWFudXBTZW1hbnRpYyA9IGZ1bmN0aW9uIChhKSB7CiAgZm9yICh2YXIgYiA9ICExLCBjID0gW10sIGQgPSAwLCBlID0gbnVsbCwgZiA9IDAsIGcgPSAwLCBoID0gMCwgbCA9IDAsIGsgPSAwOyBmIDwgYS5sZW5ndGg7KSBhW2ZdWzBdID09IERJRkZfRVFVQUwgPyAoY1tkKytdID0gZiwgZyA9IGwsIGggPSBrLCBrID0gbCA9IDAsIGUgPSBhW2ZdWzFdKSA6IChhW2ZdWzBdID09IERJRkZfSU5TRVJUID8gbCArPSBhW2ZdWzFdLmxlbmd0aCA6IGsgKz0gYVtmXVsxXS5sZW5ndGgsIGUgJiYgZS5sZW5ndGggPD0gTWF0aC5tYXgoZywgaCkgJiYgZS5sZW5ndGggPD0gTWF0aC5tYXgobCwgaykgJiYgKGEuc3BsaWNlKGNbZCAtIDFdLCAwLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfREVMRVRFLCBlKSksIGFbY1tkIC0gMV0gKyAxXVswXSA9IERJRkZfSU5TRVJULCBkLS0sIGQtLSwgZiA9IDAgPCBkID8gY1tkIC0gMV0gOiAtMSwgayA9IGwgPSBoID0gZyA9IDAsIGUgPSBudWxsLCBiID0gITApKSwgZisrOwoKICBiICYmIHRoaXMuZGlmZl9jbGVhbnVwTWVyZ2UoYSk7CiAgdGhpcy5kaWZmX2NsZWFudXBTZW1hbnRpY0xvc3NsZXNzKGEpOwoKICBmb3IgKGYgPSAxOyBmIDwgYS5sZW5ndGg7KSB7CiAgICBpZiAoYVtmIC0gMV1bMF0gPT0gRElGRl9ERUxFVEUgJiYgYVtmXVswXSA9PSBESUZGX0lOU0VSVCkgewogICAgICBiID0gYVtmIC0gMV1bMV07CiAgICAgIGMgPSBhW2ZdWzFdOwogICAgICBkID0gdGhpcy5kaWZmX2NvbW1vbk92ZXJsYXBfKGIsIGMpOwogICAgICBlID0gdGhpcy5kaWZmX2NvbW1vbk92ZXJsYXBfKGMsIGIpOwoKICAgICAgaWYgKGQgPj0gZSkgewogICAgICAgIGlmIChkID49IGIubGVuZ3RoIC8gMiB8fCBkID49IGMubGVuZ3RoIC8gMikgYS5zcGxpY2UoZiwgMCwgbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBjLnN1YnN0cmluZygwLCBkKSkpLCBhW2YgLSAxXVsxXSA9IGIuc3Vic3RyaW5nKDAsIGIubGVuZ3RoIC0gZCksIGFbZiArIDFdWzFdID0gYy5zdWJzdHJpbmcoZCksIGYrKzsKICAgICAgfSBlbHNlIGlmIChlID49IGIubGVuZ3RoIC8gMiB8fCBlID49IGMubGVuZ3RoIC8gMikgYS5zcGxpY2UoZiwgMCwgbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBiLnN1YnN0cmluZygwLCBlKSkpLCBhW2YgLSAxXVswXSA9IERJRkZfSU5TRVJULCBhW2YgLSAxXVsxXSA9IGMuc3Vic3RyaW5nKDAsIGMubGVuZ3RoIC0gZSksIGFbZiArIDFdWzBdID0gRElGRl9ERUxFVEUsIGFbZiArIDFdWzFdID0gYi5zdWJzdHJpbmcoZSksIGYrKzsKCiAgICAgIGYrKzsKICAgIH0KCiAgICBmKys7CiAgfQp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9jbGVhbnVwU2VtYW50aWNMb3NzbGVzcyA9IGZ1bmN0aW9uIChhKSB7CiAgZnVuY3Rpb24gYihhLCBiKSB7CiAgICBpZiAoIWEgfHwgIWIpIHJldHVybiA2OwogICAgdmFyIGMgPSBhLmNoYXJBdChhLmxlbmd0aCAtIDEpLAogICAgICAgIGQgPSBiLmNoYXJBdCgwKSwKICAgICAgICBlID0gYy5tYXRjaChkaWZmX21hdGNoX3BhdGNoLm5vbkFscGhhTnVtZXJpY1JlZ2V4XyksCiAgICAgICAgZiA9IGQubWF0Y2goZGlmZl9tYXRjaF9wYXRjaC5ub25BbHBoYU51bWVyaWNSZWdleF8pLAogICAgICAgIGcgPSBlICYmIGMubWF0Y2goZGlmZl9tYXRjaF9wYXRjaC53aGl0ZXNwYWNlUmVnZXhfKSwKICAgICAgICBoID0gZiAmJiBkLm1hdGNoKGRpZmZfbWF0Y2hfcGF0Y2gud2hpdGVzcGFjZVJlZ2V4Xyk7CiAgICBjID0gZyAmJiBjLm1hdGNoKGRpZmZfbWF0Y2hfcGF0Y2gubGluZWJyZWFrUmVnZXhfKTsKICAgIGQgPSBoICYmIGQubWF0Y2goZGlmZl9tYXRjaF9wYXRjaC5saW5lYnJlYWtSZWdleF8pOwogICAgdmFyIGsgPSBjICYmIGEubWF0Y2goZGlmZl9tYXRjaF9wYXRjaC5ibGFua2xpbmVFbmRSZWdleF8pLAogICAgICAgIGwgPSBkICYmIGIubWF0Y2goZGlmZl9tYXRjaF9wYXRjaC5ibGFua2xpbmVTdGFydFJlZ2V4Xyk7CiAgICByZXR1cm4gayB8fCBsID8gNSA6IGMgfHwgZCA/IDQgOiBlICYmICFnICYmIGggPyAzIDogZyB8fCBoID8gMiA6IGUgfHwgZiA/IDEgOiAwOwogIH0KCiAgZm9yICh2YXIgYyA9IDE7IGMgPCBhLmxlbmd0aCAtIDE7KSB7CiAgICBpZiAoYVtjIC0gMV1bMF0gPT0gRElGRl9FUVVBTCAmJiBhW2MgKyAxXVswXSA9PSBESUZGX0VRVUFMKSB7CiAgICAgIHZhciBkID0gYVtjIC0gMV1bMV0sCiAgICAgICAgICBlID0gYVtjXVsxXSwKICAgICAgICAgIGYgPSBhW2MgKyAxXVsxXSwKICAgICAgICAgIGcgPSB0aGlzLmRpZmZfY29tbW9uU3VmZml4KGQsIGUpOwoKICAgICAgaWYgKGcpIHsKICAgICAgICB2YXIgaCA9IGUuc3Vic3RyaW5nKGUubGVuZ3RoIC0gZyk7CiAgICAgICAgZCA9IGQuc3Vic3RyaW5nKDAsIGQubGVuZ3RoIC0gZyk7CiAgICAgICAgZSA9IGggKyBlLnN1YnN0cmluZygwLCBlLmxlbmd0aCAtIGcpOwogICAgICAgIGYgPSBoICsgZjsKICAgICAgfQoKICAgICAgZyA9IGQ7CiAgICAgIGggPSBlOwoKICAgICAgZm9yICh2YXIgbCA9IGYsIGsgPSBiKGQsIGUpICsgYihlLCBmKTsgZS5jaGFyQXQoMCkgPT09IGYuY2hhckF0KDApOykgewogICAgICAgIGQgKz0gZS5jaGFyQXQoMCk7CiAgICAgICAgZSA9IGUuc3Vic3RyaW5nKDEpICsgZi5jaGFyQXQoMCk7CiAgICAgICAgZiA9IGYuc3Vic3RyaW5nKDEpOwogICAgICAgIHZhciBtID0gYihkLCBlKSArIGIoZSwgZik7CiAgICAgICAgbSA+PSBrICYmIChrID0gbSwgZyA9IGQsIGggPSBlLCBsID0gZik7CiAgICAgIH0KCiAgICAgIGFbYyAtIDFdWzFdICE9IGcgJiYgKGcgPyBhW2MgLSAxXVsxXSA9IGcgOiAoYS5zcGxpY2UoYyAtIDEsIDEpLCBjLS0pLCBhW2NdWzFdID0gaCwgbCA/IGFbYyArIDFdWzFdID0gbCA6IChhLnNwbGljZShjICsgMSwgMSksIGMtLSkpOwogICAgfQoKICAgIGMrKzsKICB9Cn07CgpkaWZmX21hdGNoX3BhdGNoLm5vbkFscGhhTnVtZXJpY1JlZ2V4XyA9IC9bXmEtekEtWjAtOV0vOwpkaWZmX21hdGNoX3BhdGNoLndoaXRlc3BhY2VSZWdleF8gPSAvXHMvOwpkaWZmX21hdGNoX3BhdGNoLmxpbmVicmVha1JlZ2V4XyA9IC9bXHJcbl0vOwpkaWZmX21hdGNoX3BhdGNoLmJsYW5rbGluZUVuZFJlZ2V4XyA9IC9cblxyP1xuJC87CmRpZmZfbWF0Y2hfcGF0Y2guYmxhbmtsaW5lU3RhcnRSZWdleF8gPSAvXlxyP1xuXHI/XG4vOwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9jbGVhbnVwRWZmaWNpZW5jeSA9IGZ1bmN0aW9uIChhKSB7CiAgZm9yICh2YXIgYiA9ICExLCBjID0gW10sIGQgPSAwLCBlID0gbnVsbCwgZiA9IDAsIGcgPSAhMSwgaCA9ICExLCBsID0gITEsIGsgPSAhMTsgZiA8IGEubGVuZ3RoOykgYVtmXVswXSA9PSBESUZGX0VRVUFMID8gKGFbZl1bMV0ubGVuZ3RoIDwgdGhpcy5EaWZmX0VkaXRDb3N0ICYmIChsIHx8IGspID8gKGNbZCsrXSA9IGYsIGcgPSBsLCBoID0gaywgZSA9IGFbZl1bMV0pIDogKGQgPSAwLCBlID0gbnVsbCksIGwgPSBrID0gITEpIDogKGFbZl1bMF0gPT0gRElGRl9ERUxFVEUgPyBrID0gITAgOiBsID0gITAsIGUgJiYgKGcgJiYgaCAmJiBsICYmIGsgfHwgZS5sZW5ndGggPCB0aGlzLkRpZmZfRWRpdENvc3QgLyAyICYmIDMgPT0gZyArIGggKyBsICsgaykgJiYgKGEuc3BsaWNlKGNbZCAtIDFdLCAwLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfREVMRVRFLCBlKSksIGFbY1tkIC0gMV0gKyAxXVswXSA9IERJRkZfSU5TRVJULCBkLS0sIGUgPSBudWxsLCBnICYmIGggPyAobCA9IGsgPSAhMCwgZCA9IDApIDogKGQtLSwgZiA9IDAgPCBkID8gY1tkIC0gMV0gOiAtMSwgbCA9IGsgPSAhMSksIGIgPSAhMCkpLCBmKys7CgogIGIgJiYgdGhpcy5kaWZmX2NsZWFudXBNZXJnZShhKTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY2xlYW51cE1lcmdlID0gZnVuY3Rpb24gKGEpIHsKICBhLnB1c2gobmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCAiIikpOwoKICBmb3IgKHZhciBiID0gMCwgYyA9IDAsIGQgPSAwLCBlID0gIiIsIGYgPSAiIiwgZzsgYiA8IGEubGVuZ3RoOykgc3dpdGNoIChhW2JdWzBdKSB7CiAgICBjYXNlIERJRkZfSU5TRVJUOgogICAgICBkKys7CiAgICAgIGYgKz0gYVtiXVsxXTsKICAgICAgYisrOwogICAgICBicmVhazsKCiAgICBjYXNlIERJRkZfREVMRVRFOgogICAgICBjKys7CiAgICAgIGUgKz0gYVtiXVsxXTsKICAgICAgYisrOwogICAgICBicmVhazsKCiAgICBjYXNlIERJRkZfRVFVQUw6CiAgICAgIDEgPCBjICsgZCA/ICgwICE9PSBjICYmIDAgIT09IGQgJiYgKGcgPSB0aGlzLmRpZmZfY29tbW9uUHJlZml4KGYsIGUpLCAwICE9PSBnICYmICgwIDwgYiAtIGMgLSBkICYmIGFbYiAtIGMgLSBkIC0gMV1bMF0gPT0gRElGRl9FUVVBTCA/IGFbYiAtIGMgLSBkIC0gMV1bMV0gKz0gZi5zdWJzdHJpbmcoMCwgZykgOiAoYS5zcGxpY2UoMCwgMCwgbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBmLnN1YnN0cmluZygwLCBnKSkpLCBiKyspLCBmID0gZi5zdWJzdHJpbmcoZyksIGUgPSBlLnN1YnN0cmluZyhnKSksIGcgPSB0aGlzLmRpZmZfY29tbW9uU3VmZml4KGYsIGUpLCAwICE9PSBnICYmIChhW2JdWzFdID0gZi5zdWJzdHJpbmcoZi5sZW5ndGggLSBnKSArIGFbYl1bMV0sIGYgPSBmLnN1YnN0cmluZygwLCBmLmxlbmd0aCAtIGcpLCBlID0gZS5zdWJzdHJpbmcoMCwgZS5sZW5ndGggLSBnKSkpLCBiIC09IGMgKyBkLCBhLnNwbGljZShiLCBjICsgZCksIGUubGVuZ3RoICYmIChhLnNwbGljZShiLCAwLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfREVMRVRFLCBlKSksIGIrKyksIGYubGVuZ3RoICYmIChhLnNwbGljZShiLCAwLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfSU5TRVJULCBmKSksIGIrKyksIGIrKykgOiAwICE9PSBiICYmIGFbYiAtIDFdWzBdID09IERJRkZfRVFVQUwgPyAoYVtiIC0gMV1bMV0gKz0gYVtiXVsxXSwgYS5zcGxpY2UoYiwgMSkpIDogYisrLCBjID0gZCA9IDAsIGYgPSBlID0gIiI7CiAgfQoKICAiIiA9PT0gYVthLmxlbmd0aCAtIDFdWzFdICYmIGEucG9wKCk7CiAgYyA9ICExOwoKICBmb3IgKGIgPSAxOyBiIDwgYS5sZW5ndGggLSAxOykgYVtiIC0gMV1bMF0gPT0gRElGRl9FUVVBTCAmJiBhW2IgKyAxXVswXSA9PSBESUZGX0VRVUFMICYmIChhW2JdWzFdLnN1YnN0cmluZyhhW2JdWzFdLmxlbmd0aCAtIGFbYiAtIDFdWzFdLmxlbmd0aCkgPT0gYVtiIC0gMV1bMV0gPyAoYVtiXVsxXSA9IGFbYiAtIDFdWzFdICsgYVtiXVsxXS5zdWJzdHJpbmcoMCwgYVtiXVsxXS5sZW5ndGggLSBhW2IgLSAxXVsxXS5sZW5ndGgpLCBhW2IgKyAxXVsxXSA9IGFbYiAtIDFdWzFdICsgYVtiICsgMV1bMV0sIGEuc3BsaWNlKGIgLSAxLCAxKSwgYyA9ICEwKSA6IGFbYl1bMV0uc3Vic3RyaW5nKDAsIGFbYiArIDFdWzFdLmxlbmd0aCkgPT0gYVtiICsgMV1bMV0gJiYgKGFbYiAtIDFdWzFdICs9IGFbYiArIDFdWzFdLCBhW2JdWzFdID0gYVtiXVsxXS5zdWJzdHJpbmcoYVtiICsgMV1bMV0ubGVuZ3RoKSArIGFbYiArIDFdWzFdLCBhLnNwbGljZShiICsgMSwgMSksIGMgPSAhMCkpLCBiKys7CgogIGMgJiYgdGhpcy5kaWZmX2NsZWFudXBNZXJnZShhKTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfeEluZGV4ID0gZnVuY3Rpb24gKGEsIGIpIHsKICB2YXIgYyA9IDAsCiAgICAgIGQgPSAwLAogICAgICBlID0gMCwKICAgICAgZiA9IDAsCiAgICAgIGc7CgogIGZvciAoZyA9IDA7IGcgPCBhLmxlbmd0aDsgZysrKSB7CiAgICBhW2ddWzBdICE9PSBESUZGX0lOU0VSVCAmJiAoYyArPSBhW2ddWzFdLmxlbmd0aCk7CiAgICBhW2ddWzBdICE9PSBESUZGX0RFTEVURSAmJiAoZCArPSBhW2ddWzFdLmxlbmd0aCk7CiAgICBpZiAoYyA+IGIpIGJyZWFrOwogICAgZSA9IGM7CiAgICBmID0gZDsKICB9CgogIHJldHVybiBhLmxlbmd0aCAhPSBnICYmIGFbZ11bMF0gPT09IERJRkZfREVMRVRFID8gZiA6IGYgKyAoYiAtIGUpOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9wcmV0dHlIdG1sID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0gW10sIGMgPSAvJi9nLCBkID0gLzwvZywgZSA9IC8+L2csIGYgPSAvXG4vZywgZyA9IDA7IGcgPCBhLmxlbmd0aDsgZysrKSB7CiAgICB2YXIgaCA9IGFbZ11bMF0sCiAgICAgICAgbCA9IGFbZ11bMV0ucmVwbGFjZShjLCAiJmFtcDsiKS5yZXBsYWNlKGQsICImbHQ7IikucmVwbGFjZShlLCAiJmd0OyIpLnJlcGxhY2UoZiwgIiZwYXJhOzxicj4iKTsKCiAgICBzd2l0Y2ggKGgpIHsKICAgICAgY2FzZSBESUZGX0lOU0VSVDoKICAgICAgICBiW2ddID0gJzxpbnMgc3R5bGU9ImJhY2tncm91bmQ6I2U2ZmZlNjsiPicgKyBsICsgIjwvaW5zPiI7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIERJRkZfREVMRVRFOgogICAgICAgIGJbZ10gPSAnPGRlbCBzdHlsZT0iYmFja2dyb3VuZDojZmZlNmU2OyI+JyArIGwgKyAiPC9kZWw+IjsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgRElGRl9FUVVBTDoKICAgICAgICBiW2ddID0gIjxzcGFuPiIgKyBsICsgIjwvc3Bhbj4iOwogICAgfQogIH0KCiAgcmV0dXJuIGIuam9pbigiIik7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX3RleHQxID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0gW10sIGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykgYVtjXVswXSAhPT0gRElGRl9JTlNFUlQgJiYgKGJbY10gPSBhW2NdWzFdKTsKCiAgcmV0dXJuIGIuam9pbigiIik7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX3RleHQyID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0gW10sIGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykgYVtjXVswXSAhPT0gRElGRl9ERUxFVEUgJiYgKGJbY10gPSBhW2NdWzFdKTsKCiAgcmV0dXJuIGIuam9pbigiIik7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2xldmVuc2h0ZWluID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0gMCwgYyA9IDAsIGQgPSAwLCBlID0gMDsgZSA8IGEubGVuZ3RoOyBlKyspIHsKICAgIHZhciBmID0gYVtlXVsxXTsKCiAgICBzd2l0Y2ggKGFbZV1bMF0pIHsKICAgICAgY2FzZSBESUZGX0lOU0VSVDoKICAgICAgICBjICs9IGYubGVuZ3RoOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBESUZGX0RFTEVURToKICAgICAgICBkICs9IGYubGVuZ3RoOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBESUZGX0VRVUFMOgogICAgICAgIGIgKz0gTWF0aC5tYXgoYywgZCksIGQgPSBjID0gMDsKICAgIH0KICB9CgogIHJldHVybiBiICs9IE1hdGgubWF4KGMsIGQpOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl90b0RlbHRhID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0gW10sIGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykgc3dpdGNoIChhW2NdWzBdKSB7CiAgICBjYXNlIERJRkZfSU5TRVJUOgogICAgICBiW2NdID0gIisiICsgZW5jb2RlVVJJKGFbY11bMV0pOwogICAgICBicmVhazsKCiAgICBjYXNlIERJRkZfREVMRVRFOgogICAgICBiW2NdID0gIi0iICsgYVtjXVsxXS5sZW5ndGg7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgRElGRl9FUVVBTDoKICAgICAgYltjXSA9ICI9IiArIGFbY11bMV0ubGVuZ3RoOwogIH0KCiAgcmV0dXJuIGIuam9pbigiXHQiKS5yZXBsYWNlKC8lMjAvZywgIiAiKTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfZnJvbURlbHRhID0gZnVuY3Rpb24gKGEsIGIpIHsKICBmb3IgKHZhciBjID0gW10sIGQgPSAwLCBlID0gMCwgZiA9IGIuc3BsaXQoL1x0L2cpLCBnID0gMDsgZyA8IGYubGVuZ3RoOyBnKyspIHsKICAgIHZhciBoID0gZltnXS5zdWJzdHJpbmcoMSk7CgogICAgc3dpdGNoIChmW2ddLmNoYXJBdCgwKSkgewogICAgICBjYXNlICIrIjoKICAgICAgICB0cnkgewogICAgICAgICAgY1tkKytdID0gbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0lOU0VSVCwgZGVjb2RlVVJJKGgpKTsKICAgICAgICB9IGNhdGNoIChrKSB7CiAgICAgICAgICB0aHJvdyBFcnJvcigiSWxsZWdhbCBlc2NhcGUgaW4gZGlmZl9mcm9tRGVsdGE6ICIgKyBoKTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiLSI6CiAgICAgIGNhc2UgIj0iOgogICAgICAgIHZhciBsID0gcGFyc2VJbnQoaCwgMTApOwogICAgICAgIGlmIChpc05hTihsKSB8fCAwID4gbCkgdGhyb3cgRXJyb3IoIkludmFsaWQgbnVtYmVyIGluIGRpZmZfZnJvbURlbHRhOiAiICsgaCk7CiAgICAgICAgaCA9IGEuc3Vic3RyaW5nKGUsIGUgKz0gbCk7CiAgICAgICAgIj0iID09IGZbZ10uY2hhckF0KDApID8gY1tkKytdID0gbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBoKSA6IGNbZCsrXSA9IG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9ERUxFVEUsIGgpOwogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICBpZiAoZltnXSkgdGhyb3cgRXJyb3IoIkludmFsaWQgZGlmZiBvcGVyYXRpb24gaW4gZGlmZl9mcm9tRGVsdGE6ICIgKyBmW2ddKTsKICAgIH0KICB9CgogIGlmIChlICE9IGEubGVuZ3RoKSB0aHJvdyBFcnJvcigiRGVsdGEgbGVuZ3RoICgiICsgZSArICIpIGRvZXMgbm90IGVxdWFsIHNvdXJjZSB0ZXh0IGxlbmd0aCAoIiArIGEubGVuZ3RoICsgIikuIik7CiAgcmV0dXJuIGM7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5tYXRjaF9tYWluID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsKICBpZiAobnVsbCA9PSBhIHx8IG51bGwgPT0gYiB8fCBudWxsID09IGMpIHRocm93IEVycm9yKCJOdWxsIGlucHV0LiAobWF0Y2hfbWFpbikiKTsKICBjID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oYywgYS5sZW5ndGgpKTsKICByZXR1cm4gYSA9PSBiID8gMCA6IGEubGVuZ3RoID8gYS5zdWJzdHJpbmcoYywgYyArIGIubGVuZ3RoKSA9PSBiID8gYyA6IHRoaXMubWF0Y2hfYml0YXBfKGEsIGIsIGMpIDogLTE7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5tYXRjaF9iaXRhcF8gPSBmdW5jdGlvbiAoYSwgYiwgYykgewogIGZ1bmN0aW9uIGQoYSwgZCkgewogICAgdmFyIGUgPSBhIC8gYi5sZW5ndGgsCiAgICAgICAgZyA9IE1hdGguYWJzKGMgLSBkKTsKICAgIHJldHVybiBmLk1hdGNoX0Rpc3RhbmNlID8gZSArIGcgLyBmLk1hdGNoX0Rpc3RhbmNlIDogZyA/IDEgOiBlOwogIH0KCiAgaWYgKGIubGVuZ3RoID4gdGhpcy5NYXRjaF9NYXhCaXRzKSB0aHJvdyBFcnJvcigiUGF0dGVybiB0b28gbG9uZyBmb3IgdGhpcyBicm93c2VyLiIpOwogIHZhciBlID0gdGhpcy5tYXRjaF9hbHBoYWJldF8oYiksCiAgICAgIGYgPSB0aGlzLAogICAgICBnID0gdGhpcy5NYXRjaF9UaHJlc2hvbGQsCiAgICAgIGggPSBhLmluZGV4T2YoYiwgYyk7CiAgLTEgIT0gaCAmJiAoZyA9IE1hdGgubWluKGQoMCwgaCksIGcpLCBoID0gYS5sYXN0SW5kZXhPZihiLCBjICsgYi5sZW5ndGgpLCAtMSAhPSBoICYmIChnID0gTWF0aC5taW4oZCgwLCBoKSwgZykpKTsKICB2YXIgbCA9IDEgPDwgYi5sZW5ndGggLSAxOwogIGggPSAtMTsKCiAgZm9yICh2YXIgaywgbSwgcCA9IGIubGVuZ3RoICsgYS5sZW5ndGgsIHgsIHcgPSAwOyB3IDwgYi5sZW5ndGg7IHcrKykgewogICAgayA9IDA7CgogICAgZm9yIChtID0gcDsgayA8IG07KSBkKHcsIGMgKyBtKSA8PSBnID8gayA9IG0gOiBwID0gbSwgbSA9IE1hdGguZmxvb3IoKHAgLSBrKSAvIDIgKyBrKTsKCiAgICBwID0gbTsKICAgIGsgPSBNYXRoLm1heCgxLCBjIC0gbSArIDEpOwogICAgdmFyIHEgPSBNYXRoLm1pbihjICsgbSwgYS5sZW5ndGgpICsgYi5sZW5ndGg7CiAgICBtID0gQXJyYXkocSArIDIpOwoKICAgIGZvciAobVtxICsgMV0gPSAoMSA8PCB3KSAtIDE7IHEgPj0gazsgcS0tKSB7CiAgICAgIHZhciB0ID0gZVthLmNoYXJBdChxIC0gMSldOwogICAgICBtW3FdID0gMCA9PT0gdyA/IChtW3EgKyAxXSA8PCAxIHwgMSkgJiB0IDogKG1bcSArIDFdIDw8IDEgfCAxKSAmIHQgfCAoeFtxICsgMV0gfCB4W3FdKSA8PCAxIHwgMSB8IHhbcSArIDFdOwogICAgICBpZiAobVtxXSAmIGwgJiYgKHQgPSBkKHcsIHEgLSAxKSwgdCA8PSBnKSkgaWYgKGcgPSB0LCBoID0gcSAtIDEsIGggPiBjKSBrID0gTWF0aC5tYXgoMSwgMiAqIGMgLSBoKTtlbHNlIGJyZWFrOwogICAgfQoKICAgIGlmIChkKHcgKyAxLCBjKSA+IGcpIGJyZWFrOwogICAgeCA9IG07CiAgfQoKICByZXR1cm4gaDsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLm1hdGNoX2FscGhhYmV0XyA9IGZ1bmN0aW9uIChhKSB7CiAgZm9yICh2YXIgYiA9IHt9LCBjID0gMDsgYyA8IGEubGVuZ3RoOyBjKyspIGJbYS5jaGFyQXQoYyldID0gMDsKCiAgZm9yIChjID0gMDsgYyA8IGEubGVuZ3RoOyBjKyspIGJbYS5jaGFyQXQoYyldIHw9IDEgPDwgYS5sZW5ndGggLSBjIC0gMTsKCiAgcmV0dXJuIGI7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5wYXRjaF9hZGRDb250ZXh0XyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgaWYgKDAgIT0gYi5sZW5ndGgpIHsKICAgIGlmIChudWxsID09PSBhLnN0YXJ0MikgdGhyb3cgRXJyb3IoInBhdGNoIG5vdCBpbml0aWFsaXplZCIpOwoKICAgIGZvciAodmFyIGMgPSBiLnN1YnN0cmluZyhhLnN0YXJ0MiwgYS5zdGFydDIgKyBhLmxlbmd0aDEpLCBkID0gMDsgYi5pbmRleE9mKGMpICE9IGIubGFzdEluZGV4T2YoYykgJiYgYy5sZW5ndGggPCB0aGlzLk1hdGNoX01heEJpdHMgLSB0aGlzLlBhdGNoX01hcmdpbiAtIHRoaXMuUGF0Y2hfTWFyZ2luOykgZCArPSB0aGlzLlBhdGNoX01hcmdpbiwgYyA9IGIuc3Vic3RyaW5nKGEuc3RhcnQyIC0gZCwgYS5zdGFydDIgKyBhLmxlbmd0aDEgKyBkKTsKCiAgICBkICs9IHRoaXMuUGF0Y2hfTWFyZ2luOwogICAgKGMgPSBiLnN1YnN0cmluZyhhLnN0YXJ0MiAtIGQsIGEuc3RhcnQyKSkgJiYgYS5kaWZmcy51bnNoaWZ0KG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgYykpOwogICAgKGQgPSBiLnN1YnN0cmluZyhhLnN0YXJ0MiArIGEubGVuZ3RoMSwgYS5zdGFydDIgKyBhLmxlbmd0aDEgKyBkKSkgJiYgYS5kaWZmcy5wdXNoKG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgZCkpOwogICAgYS5zdGFydDEgLT0gYy5sZW5ndGg7CiAgICBhLnN0YXJ0MiAtPSBjLmxlbmd0aDsKICAgIGEubGVuZ3RoMSArPSBjLmxlbmd0aCArIGQubGVuZ3RoOwogICAgYS5sZW5ndGgyICs9IGMubGVuZ3RoICsgZC5sZW5ndGg7CiAgfQp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUucGF0Y2hfbWFrZSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7CiAgaWYgKCJzdHJpbmciID09IHR5cGVvZiBhICYmICJzdHJpbmciID09IHR5cGVvZiBiICYmICJ1bmRlZmluZWQiID09IHR5cGVvZiBjKSB7CiAgICB2YXIgZCA9IGE7CiAgICBiID0gdGhpcy5kaWZmX21haW4oZCwgYiwgITApOwogICAgMiA8IGIubGVuZ3RoICYmICh0aGlzLmRpZmZfY2xlYW51cFNlbWFudGljKGIpLCB0aGlzLmRpZmZfY2xlYW51cEVmZmljaWVuY3koYikpOwogIH0gZWxzZSBpZiAoYSAmJiAib2JqZWN0IiA9PSB0eXBlb2YgYSAmJiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgYiAmJiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgYykgYiA9IGEsIGQgPSB0aGlzLmRpZmZfdGV4dDEoYik7ZWxzZSBpZiAoInN0cmluZyIgPT0gdHlwZW9mIGEgJiYgYiAmJiAib2JqZWN0IiA9PSB0eXBlb2YgYiAmJiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgYykgZCA9IGE7ZWxzZSBpZiAoInN0cmluZyIgPT0gdHlwZW9mIGEgJiYgInN0cmluZyIgPT0gdHlwZW9mIGIgJiYgYyAmJiAib2JqZWN0IiA9PSB0eXBlb2YgYykgZCA9IGEsIGIgPSBjO2Vsc2UgdGhyb3cgRXJyb3IoIlVua25vd24gY2FsbCBmb3JtYXQgdG8gcGF0Y2hfbWFrZS4iKTsKCiAgaWYgKDAgPT09IGIubGVuZ3RoKSByZXR1cm4gW107CiAgYyA9IFtdOwogIGEgPSBuZXcgZGlmZl9tYXRjaF9wYXRjaC5wYXRjaF9vYmooKTsKCiAgZm9yICh2YXIgZSA9IDAsIGYgPSAwLCBnID0gMCwgaCA9IGQsIGwgPSAwOyBsIDwgYi5sZW5ndGg7IGwrKykgewogICAgdmFyIGsgPSBiW2xdWzBdLAogICAgICAgIG0gPSBiW2xdWzFdOwogICAgZSB8fCBrID09PSBESUZGX0VRVUFMIHx8IChhLnN0YXJ0MSA9IGYsIGEuc3RhcnQyID0gZyk7CgogICAgc3dpdGNoIChrKSB7CiAgICAgIGNhc2UgRElGRl9JTlNFUlQ6CiAgICAgICAgYS5kaWZmc1tlKytdID0gYltsXTsKICAgICAgICBhLmxlbmd0aDIgKz0gbS5sZW5ndGg7CiAgICAgICAgZCA9IGQuc3Vic3RyaW5nKDAsIGcpICsgbSArIGQuc3Vic3RyaW5nKGcpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBESUZGX0RFTEVURToKICAgICAgICBhLmxlbmd0aDEgKz0gbS5sZW5ndGg7CiAgICAgICAgYS5kaWZmc1tlKytdID0gYltsXTsKICAgICAgICBkID0gZC5zdWJzdHJpbmcoMCwgZykgKyBkLnN1YnN0cmluZyhnICsgbS5sZW5ndGgpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBESUZGX0VRVUFMOgogICAgICAgIG0ubGVuZ3RoIDw9IDIgKiB0aGlzLlBhdGNoX01hcmdpbiAmJiBlICYmIGIubGVuZ3RoICE9IGwgKyAxID8gKGEuZGlmZnNbZSsrXSA9IGJbbF0sIGEubGVuZ3RoMSArPSBtLmxlbmd0aCwgYS5sZW5ndGgyICs9IG0ubGVuZ3RoKSA6IG0ubGVuZ3RoID49IDIgKiB0aGlzLlBhdGNoX01hcmdpbiAmJiBlICYmICh0aGlzLnBhdGNoX2FkZENvbnRleHRfKGEsIGgpLCBjLnB1c2goYSksIGEgPSBuZXcgZGlmZl9tYXRjaF9wYXRjaC5wYXRjaF9vYmooKSwgZSA9IDAsIGggPSBkLCBmID0gZyk7CiAgICB9CgogICAgayAhPT0gRElGRl9JTlNFUlQgJiYgKGYgKz0gbS5sZW5ndGgpOwogICAgayAhPT0gRElGRl9ERUxFVEUgJiYgKGcgKz0gbS5sZW5ndGgpOwogIH0KCiAgZSAmJiAodGhpcy5wYXRjaF9hZGRDb250ZXh0XyhhLCBoKSwgYy5wdXNoKGEpKTsKICByZXR1cm4gYzsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLnBhdGNoX2RlZXBDb3B5ID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0gW10sIGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykgewogICAgdmFyIGQgPSBhW2NdLAogICAgICAgIGUgPSBuZXcgZGlmZl9tYXRjaF9wYXRjaC5wYXRjaF9vYmooKTsKICAgIGUuZGlmZnMgPSBbXTsKCiAgICBmb3IgKHZhciBmID0gMDsgZiA8IGQuZGlmZnMubGVuZ3RoOyBmKyspIGUuZGlmZnNbZl0gPSBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKGQuZGlmZnNbZl1bMF0sIGQuZGlmZnNbZl1bMV0pOwoKICAgIGUuc3RhcnQxID0gZC5zdGFydDE7CiAgICBlLnN0YXJ0MiA9IGQuc3RhcnQyOwogICAgZS5sZW5ndGgxID0gZC5sZW5ndGgxOwogICAgZS5sZW5ndGgyID0gZC5sZW5ndGgyOwogICAgYltjXSA9IGU7CiAgfQoKICByZXR1cm4gYjsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLnBhdGNoX2FwcGx5ID0gZnVuY3Rpb24gKGEsIGIpIHsKICBpZiAoMCA9PSBhLmxlbmd0aCkgcmV0dXJuIFtiLCBbXV07CiAgYSA9IHRoaXMucGF0Y2hfZGVlcENvcHkoYSk7CiAgdmFyIGMgPSB0aGlzLnBhdGNoX2FkZFBhZGRpbmcoYSk7CiAgYiA9IGMgKyBiICsgYzsKICB0aGlzLnBhdGNoX3NwbGl0TWF4KGEpOwoKICBmb3IgKHZhciBkID0gMCwgZSA9IFtdLCBmID0gMDsgZiA8IGEubGVuZ3RoOyBmKyspIHsKICAgIHZhciBnID0gYVtmXS5zdGFydDIgKyBkLAogICAgICAgIGggPSB0aGlzLmRpZmZfdGV4dDEoYVtmXS5kaWZmcyksCiAgICAgICAgbCA9IC0xOwoKICAgIGlmIChoLmxlbmd0aCA+IHRoaXMuTWF0Y2hfTWF4Qml0cykgewogICAgICB2YXIgayA9IHRoaXMubWF0Y2hfbWFpbihiLCBoLnN1YnN0cmluZygwLCB0aGlzLk1hdGNoX01heEJpdHMpLCBnKTsKICAgICAgLTEgIT0gayAmJiAobCA9IHRoaXMubWF0Y2hfbWFpbihiLCBoLnN1YnN0cmluZyhoLmxlbmd0aCAtIHRoaXMuTWF0Y2hfTWF4Qml0cyksIGcgKyBoLmxlbmd0aCAtIHRoaXMuTWF0Y2hfTWF4Qml0cyksIC0xID09IGwgfHwgayA+PSBsKSAmJiAoayA9IC0xKTsKICAgIH0gZWxzZSBrID0gdGhpcy5tYXRjaF9tYWluKGIsIGgsIGcpOwoKICAgIGlmICgtMSA9PSBrKSBlW2ZdID0gITEsIGQgLT0gYVtmXS5sZW5ndGgyIC0gYVtmXS5sZW5ndGgxO2Vsc2UgaWYgKGVbZl0gPSAhMCwgZCA9IGsgLSBnLCBnID0gLTEgPT0gbCA/IGIuc3Vic3RyaW5nKGssIGsgKyBoLmxlbmd0aCkgOiBiLnN1YnN0cmluZyhrLCBsICsgdGhpcy5NYXRjaF9NYXhCaXRzKSwgaCA9PSBnKSBiID0gYi5zdWJzdHJpbmcoMCwgaykgKyB0aGlzLmRpZmZfdGV4dDIoYVtmXS5kaWZmcykgKyBiLnN1YnN0cmluZyhrICsgaC5sZW5ndGgpO2Vsc2UgaWYgKGcgPSB0aGlzLmRpZmZfbWFpbihoLCBnLCAhMSksIGgubGVuZ3RoID4gdGhpcy5NYXRjaF9NYXhCaXRzICYmIHRoaXMuZGlmZl9sZXZlbnNodGVpbihnKSAvIGgubGVuZ3RoID4gdGhpcy5QYXRjaF9EZWxldGVUaHJlc2hvbGQpIGVbZl0gPSAhMTtlbHNlIHsKICAgICAgdGhpcy5kaWZmX2NsZWFudXBTZW1hbnRpY0xvc3NsZXNzKGcpOwogICAgICBoID0gMDsKICAgICAgdmFyIG07CgogICAgICBmb3IgKGwgPSAwOyBsIDwgYVtmXS5kaWZmcy5sZW5ndGg7IGwrKykgewogICAgICAgIHZhciBwID0gYVtmXS5kaWZmc1tsXTsKICAgICAgICBwWzBdICE9PSBESUZGX0VRVUFMICYmIChtID0gdGhpcy5kaWZmX3hJbmRleChnLCBoKSk7CiAgICAgICAgcFswXSA9PT0gRElGRl9JTlNFUlQgPyBiID0gYi5zdWJzdHJpbmcoMCwgayArIG0pICsgcFsxXSArIGIuc3Vic3RyaW5nKGsgKyBtKSA6IHBbMF0gPT09IERJRkZfREVMRVRFICYmIChiID0gYi5zdWJzdHJpbmcoMCwgayArIG0pICsgYi5zdWJzdHJpbmcoayArIHRoaXMuZGlmZl94SW5kZXgoZywgaCArIHBbMV0ubGVuZ3RoKSkpOwogICAgICAgIHBbMF0gIT09IERJRkZfREVMRVRFICYmIChoICs9IHBbMV0ubGVuZ3RoKTsKICAgICAgfQogICAgfQogIH0KCiAgYiA9IGIuc3Vic3RyaW5nKGMubGVuZ3RoLCBiLmxlbmd0aCAtIGMubGVuZ3RoKTsKICByZXR1cm4gW2IsIGVdOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUucGF0Y2hfYWRkUGFkZGluZyA9IGZ1bmN0aW9uIChhKSB7CiAgZm9yICh2YXIgYiA9IHRoaXMuUGF0Y2hfTWFyZ2luLCBjID0gIiIsIGQgPSAxOyBkIDw9IGI7IGQrKykgYyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGQpOwoKICBmb3IgKGQgPSAwOyBkIDwgYS5sZW5ndGg7IGQrKykgYVtkXS5zdGFydDEgKz0gYiwgYVtkXS5zdGFydDIgKz0gYjsKCiAgZCA9IGFbMF07CiAgdmFyIGUgPSBkLmRpZmZzOwogIGlmICgwID09IGUubGVuZ3RoIHx8IGVbMF1bMF0gIT0gRElGRl9FUVVBTCkgZS51bnNoaWZ0KG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgYykpLCBkLnN0YXJ0MSAtPSBiLCBkLnN0YXJ0MiAtPSBiLCBkLmxlbmd0aDEgKz0gYiwgZC5sZW5ndGgyICs9IGI7ZWxzZSBpZiAoYiA+IGVbMF1bMV0ubGVuZ3RoKSB7CiAgICB2YXIgZiA9IGIgLSBlWzBdWzFdLmxlbmd0aDsKICAgIGVbMF1bMV0gPSBjLnN1YnN0cmluZyhlWzBdWzFdLmxlbmd0aCkgKyBlWzBdWzFdOwogICAgZC5zdGFydDEgLT0gZjsKICAgIGQuc3RhcnQyIC09IGY7CiAgICBkLmxlbmd0aDEgKz0gZjsKICAgIGQubGVuZ3RoMiArPSBmOwogIH0KICBkID0gYVthLmxlbmd0aCAtIDFdOwogIGUgPSBkLmRpZmZzOwogIDAgPT0gZS5sZW5ndGggfHwgZVtlLmxlbmd0aCAtIDFdWzBdICE9IERJRkZfRVFVQUwgPyAoZS5wdXNoKG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgYykpLCBkLmxlbmd0aDEgKz0gYiwgZC5sZW5ndGgyICs9IGIpIDogYiA+IGVbZS5sZW5ndGggLSAxXVsxXS5sZW5ndGggJiYgKGYgPSBiIC0gZVtlLmxlbmd0aCAtIDFdWzFdLmxlbmd0aCwgZVtlLmxlbmd0aCAtIDFdWzFdICs9IGMuc3Vic3RyaW5nKDAsIGYpLCBkLmxlbmd0aDEgKz0gZiwgZC5sZW5ndGgyICs9IGYpOwogIHJldHVybiBjOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUucGF0Y2hfc3BsaXRNYXggPSBmdW5jdGlvbiAoYSkgewogIGZvciAodmFyIGIgPSB0aGlzLk1hdGNoX01heEJpdHMsIGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykgaWYgKCEoYVtjXS5sZW5ndGgxIDw9IGIpKSB7CiAgICB2YXIgZCA9IGFbY107CiAgICBhLnNwbGljZShjLS0sIDEpOwoKICAgIGZvciAodmFyIGUgPSBkLnN0YXJ0MSwgZiA9IGQuc3RhcnQyLCBnID0gIiI7IDAgIT09IGQuZGlmZnMubGVuZ3RoOykgewogICAgICB2YXIgaCA9IG5ldyBkaWZmX21hdGNoX3BhdGNoLnBhdGNoX29iaigpLAogICAgICAgICAgbCA9ICEwOwogICAgICBoLnN0YXJ0MSA9IGUgLSBnLmxlbmd0aDsKICAgICAgaC5zdGFydDIgPSBmIC0gZy5sZW5ndGg7CiAgICAgICIiICE9PSBnICYmIChoLmxlbmd0aDEgPSBoLmxlbmd0aDIgPSBnLmxlbmd0aCwgaC5kaWZmcy5wdXNoKG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgZykpKTsKCiAgICAgIGZvciAoOyAwICE9PSBkLmRpZmZzLmxlbmd0aCAmJiBoLmxlbmd0aDEgPCBiIC0gdGhpcy5QYXRjaF9NYXJnaW47KSB7CiAgICAgICAgZyA9IGQuZGlmZnNbMF1bMF07CiAgICAgICAgdmFyIGsgPSBkLmRpZmZzWzBdWzFdOwogICAgICAgIGcgPT09IERJRkZfSU5TRVJUID8gKGgubGVuZ3RoMiArPSBrLmxlbmd0aCwgZiArPSBrLmxlbmd0aCwgaC5kaWZmcy5wdXNoKGQuZGlmZnMuc2hpZnQoKSksIGwgPSAhMSkgOiBnID09PSBESUZGX0RFTEVURSAmJiAxID09IGguZGlmZnMubGVuZ3RoICYmIGguZGlmZnNbMF1bMF0gPT0gRElGRl9FUVVBTCAmJiBrLmxlbmd0aCA+IDIgKiBiID8gKGgubGVuZ3RoMSArPSBrLmxlbmd0aCwgZSArPSBrLmxlbmd0aCwgbCA9ICExLCBoLmRpZmZzLnB1c2gobmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihnLCBrKSksIGQuZGlmZnMuc2hpZnQoKSkgOiAoayA9IGsuc3Vic3RyaW5nKDAsIGIgLSBoLmxlbmd0aDEgLSB0aGlzLlBhdGNoX01hcmdpbiksIGgubGVuZ3RoMSArPSBrLmxlbmd0aCwgZSArPSBrLmxlbmd0aCwgZyA9PT0gRElGRl9FUVVBTCA/IChoLmxlbmd0aDIgKz0gay5sZW5ndGgsIGYgKz0gay5sZW5ndGgpIDogbCA9ICExLCBoLmRpZmZzLnB1c2gobmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihnLCBrKSksIGsgPT0gZC5kaWZmc1swXVsxXSA/IGQuZGlmZnMuc2hpZnQoKSA6IGQuZGlmZnNbMF1bMV0gPSBkLmRpZmZzWzBdWzFdLnN1YnN0cmluZyhrLmxlbmd0aCkpOwogICAgICB9CgogICAgICBnID0gdGhpcy5kaWZmX3RleHQyKGguZGlmZnMpOwogICAgICBnID0gZy5zdWJzdHJpbmcoZy5sZW5ndGggLSB0aGlzLlBhdGNoX01hcmdpbik7CiAgICAgIGsgPSB0aGlzLmRpZmZfdGV4dDEoZC5kaWZmcykuc3Vic3RyaW5nKDAsIHRoaXMuUGF0Y2hfTWFyZ2luKTsKICAgICAgIiIgIT09IGsgJiYgKGgubGVuZ3RoMSArPSBrLmxlbmd0aCwgaC5sZW5ndGgyICs9IGsubGVuZ3RoLCAwICE9PSBoLmRpZmZzLmxlbmd0aCAmJiBoLmRpZmZzW2guZGlmZnMubGVuZ3RoIC0gMV1bMF0gPT09IERJRkZfRVFVQUwgPyBoLmRpZmZzW2guZGlmZnMubGVuZ3RoIC0gMV1bMV0gKz0gayA6IGguZGlmZnMucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGspKSk7CiAgICAgIGwgfHwgYS5zcGxpY2UoKytjLCAwLCBoKTsKICAgIH0KICB9Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5wYXRjaF90b1RleHQgPSBmdW5jdGlvbiAoYSkgewogIGZvciAodmFyIGIgPSBbXSwgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSBiW2NdID0gYVtjXTsKCiAgcmV0dXJuIGIuam9pbigiIik7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5wYXRjaF9mcm9tVGV4dCA9IGZ1bmN0aW9uIChhKSB7CiAgdmFyIGIgPSBbXTsKICBpZiAoIWEpIHJldHVybiBiOwogIGEgPSBhLnNwbGl0KCJcbiIpOwoKICBmb3IgKHZhciBjID0gMCwgZCA9IC9eQEAgLShcZCspLD8oXGQqKSBcKyhcZCspLD8oXGQqKSBAQCQvOyBjIDwgYS5sZW5ndGg7KSB7CiAgICB2YXIgZSA9IGFbY10ubWF0Y2goZCk7CiAgICBpZiAoIWUpIHRocm93IEVycm9yKCJJbnZhbGlkIHBhdGNoIHN0cmluZzogIiArIGFbY10pOwogICAgdmFyIGYgPSBuZXcgZGlmZl9tYXRjaF9wYXRjaC5wYXRjaF9vYmooKTsKICAgIGIucHVzaChmKTsKICAgIGYuc3RhcnQxID0gcGFyc2VJbnQoZVsxXSwgMTApOwogICAgIiIgPT09IGVbMl0gPyAoZi5zdGFydDEtLSwgZi5sZW5ndGgxID0gMSkgOiAiMCIgPT0gZVsyXSA/IGYubGVuZ3RoMSA9IDAgOiAoZi5zdGFydDEtLSwgZi5sZW5ndGgxID0gcGFyc2VJbnQoZVsyXSwgMTApKTsKICAgIGYuc3RhcnQyID0gcGFyc2VJbnQoZVszXSwgMTApOwogICAgIiIgPT09IGVbNF0gPyAoZi5zdGFydDItLSwgZi5sZW5ndGgyID0gMSkgOiAiMCIgPT0gZVs0XSA/IGYubGVuZ3RoMiA9IDAgOiAoZi5zdGFydDItLSwgZi5sZW5ndGgyID0gcGFyc2VJbnQoZVs0XSwgMTApKTsKCiAgICBmb3IgKGMrKzsgYyA8IGEubGVuZ3RoOykgewogICAgICBlID0gYVtjXS5jaGFyQXQoMCk7CgogICAgICB0cnkgewogICAgICAgIHZhciBnID0gZGVjb2RlVVJJKGFbY10uc3Vic3RyaW5nKDEpKTsKICAgICAgfSBjYXRjaCAoaCkgewogICAgICAgIHRocm93IEVycm9yKCJJbGxlZ2FsIGVzY2FwZSBpbiBwYXRjaF9mcm9tVGV4dDogIiArIGcpOwogICAgICB9CgogICAgICBpZiAoIi0iID09IGUpIGYuZGlmZnMucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfREVMRVRFLCBnKSk7ZWxzZSBpZiAoIisiID09IGUpIGYuZGlmZnMucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfSU5TRVJULCBnKSk7ZWxzZSBpZiAoIiAiID09IGUpIGYuZGlmZnMucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGcpKTtlbHNlIGlmICgiQCIgPT0gZSkgYnJlYWs7ZWxzZSBpZiAoIiIgIT09IGUpIHRocm93IEVycm9yKCdJbnZhbGlkIHBhdGNoIG1vZGUgIicgKyBlICsgJyIgaW46ICcgKyBnKTsKICAgICAgYysrOwogICAgfQogIH0KCiAgcmV0dXJuIGI7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnBhdGNoX29iaiA9IGZ1bmN0aW9uICgpIHsKICB0aGlzLmRpZmZzID0gW107CiAgdGhpcy5zdGFydDIgPSB0aGlzLnN0YXJ0MSA9IG51bGw7CiAgdGhpcy5sZW5ndGgyID0gdGhpcy5sZW5ndGgxID0gMDsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucGF0Y2hfb2JqLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKICBmb3IgKHZhciBhID0gWyJAQCAtIiArICgwID09PSB0aGlzLmxlbmd0aDEgPyB0aGlzLnN0YXJ0MSArICIsMCIgOiAxID09IHRoaXMubGVuZ3RoMSA/IHRoaXMuc3RhcnQxICsgMSA6IHRoaXMuc3RhcnQxICsgMSArICIsIiArIHRoaXMubGVuZ3RoMSkgKyAiICsiICsgKDAgPT09IHRoaXMubGVuZ3RoMiA/IHRoaXMuc3RhcnQyICsgIiwwIiA6IDEgPT0gdGhpcy5sZW5ndGgyID8gdGhpcy5zdGFydDIgKyAxIDogdGhpcy5zdGFydDIgKyAxICsgIiwiICsgdGhpcy5sZW5ndGgyKSArICIgQEBcbiJdLCBiLCBjID0gMDsgYyA8IHRoaXMuZGlmZnMubGVuZ3RoOyBjKyspIHsKICAgIHN3aXRjaCAodGhpcy5kaWZmc1tjXVswXSkgewogICAgICBjYXNlIERJRkZfSU5TRVJUOgogICAgICAgIGIgPSAiKyI7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIERJRkZfREVMRVRFOgogICAgICAgIGIgPSAiLSI7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIERJRkZfRVFVQUw6CiAgICAgICAgYiA9ICIgIjsKICAgIH0KCiAgICBhW2MgKyAxXSA9IGIgKyBlbmNvZGVVUkkodGhpcy5kaWZmc1tjXVsxXSkgKyAiXG4iOwogIH0KCiAgcmV0dXJuIGEuam9pbigiIikucmVwbGFjZSgvJTIwL2csICIgIik7Cn07Cgp0aGlzLmRpZmZfbWF0Y2hfcGF0Y2ggPSBkaWZmX21hdGNoX3BhdGNoOwp0aGlzLkRJRkZfREVMRVRFID0gRElGRl9ERUxFVEU7CnRoaXMuRElGRl9JTlNFUlQgPSBESUZGX0lOU0VSVDsKdGhpcy5ESUZGX0VRVUFMID0gRElGRl9FUVVBTDsKd2luZG93LmRpZmZfbWF0Y2hfcGF0Y2ggPSBkaWZmX21hdGNoX3BhdGNoOwp3aW5kb3cuRElGRl9JTlNFUlQgPSBESUZGX0lOU0VSVDsKd2luZG93LkRJRkZfREVMRVRFID0gRElGRl9ERUxFVEU7CndpbmRvdy5ESUZGX0VRVUFMID0gRElGRl9FUVVBTDs="},null]}